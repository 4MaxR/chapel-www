

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Building Code in Other Languages &mdash; Chapel Documentation 2.7</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/style.css?v=70f659a1" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=dfec817d"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Mason-Registry" href="masonregistry.html" />
    <link rel="prev" title="Using Non-Chapel Dependencies" href="externaldependencies.html" />
   
  

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

<a href="../../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>2.7
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "2.7";
$pagename = "tools/mason/guide/prereqs";
include "../../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#documentation">Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#development">Development</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../chpl-language-server/chpl-language-server.html">chpl-language-server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../chplcheck/chplcheck.html">chplcheck</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../chplvis/chplvis.html">chplvis</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../mason.html">Mason</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../mason.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mason.html#when-to-leverage-mason-for-chapel-builds">When to Leverage Mason for Chapel Builds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mason.html#quick-start-instructions">Quick Start Instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mason.html#getting-started-with-mason">Getting Started with Mason</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../mason.html#mason-guide">Mason Guide</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#interoperability">Interoperability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/index.html">Docs for Contributors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Writing Chapel Programs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mason-packages/index.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

  <p class="caption" role="heading"><span class="caption-text">Indexes</span></p>
  <ul>
    <li class="toctree-11"><a class="reference internal" href="../../../chpl-modindex.html">Chapel Module Index</a></li>
    <li class="toctree-11"><a class="reference internal" href="../../../genindex.html">Complete Docs Index</a></li>
  </ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Chapel Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Tools</a></li>
          <li class="breadcrumb-item"><a href="../mason.html">Mason</a></li>
      <li class="breadcrumb-item active">Building Code in Other Languages</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/tools/mason/guide/prereqs.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="building-code-in-other-languages">
<h1>Building Code in Other Languages<a class="headerlink" href="#building-code-in-other-languages" title="Link to this heading"></a></h1>
<p>Some Mason packages may include code in languages other than Chapel. A common
scenario for this is when the package needs to interoperate with other
languages. The code in other languages in such a scenario is called
“prerequisites”. Chapel 2.7 release includes Mason with initial support for
prerequisites.</p>
<section id="understanding-prerequisites">
<h2>Understanding Prerequisites<a class="headerlink" href="#understanding-prerequisites" title="Link to this heading"></a></h2>
<p>While they are similar to dependencies, prerequisites are an inherent part of
the Mason package whereas dependencies need to be built and installed before
Mason can start building a package. Consider a scenario in which your Mason
package has a dependency on a C or C++ library, and that you need to implement a
shim between that library and the Chapel code. That shim needs to be compiled
before the Chapel code and needs to be linked. Obviously, the Chapel compiler
cannot be used in this case. Moreover, depending on the library, build process
can be completely different from one scenario to another.</p>
<p>Mason can use other tools to build such code that is part of your package.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As of Chapel 2.7, prerequisite support is prototypical. We plan to expand
the capabilities and make the implementation more robust in future releases.
If you encounter any issue, or have a feature request related to
prerequisites, please <a class="reference external" href="https://github.com/chapel-lang/chapel/issues/new?template=01-feature_request.md">create an issue</a>.</p>
</div>
</section>
<section id="a-hello-world-example">
<h2>A “Hello, world!” Example<a class="headerlink" href="#a-hello-world-example" title="Link to this heading"></a></h2>
<p>Consider a Mason application where “Hello, world!” is printed through a C
function that Chapel calls. The key source files in this scenario are:</p>
<ul class="simple">
<li><p>Hello.chpl</p></li>
</ul>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="nc">prereq1</span> <span class="p">{</span>
  <span class="k">extern</span> <span class="k">proc</span> <span class="nf">hello</span><span class="p">();</span>

  <span class="k">proc</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">hello</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>hello.h</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">hello</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>hello.c</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;hello.h&quot;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">hello</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As of Chapel 2.7, building this project with Mason requires:</p>
<ul>
<li><p>A <code class="docutils literal notranslate"><span class="pre">prereqs</span></code> directory at the project root,</p></li>
<li><p>Each prerequisite to have a subdirectory within <code class="docutils literal notranslate"><span class="pre">prereqs</span></code>,</p></li>
<li><p>Within each prerequisite’s directory a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>,</p></li>
<li><p>Each <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> to support two targets</p>
<blockquote>
<div><ul class="simple">
<li><p>The default target, invoked by <code class="docutils literal notranslate"><span class="pre">make</span></code>: To build the external code into
something that Chapel compiler link against, typically an object file</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">printchplflags</span></code> target, invoked by <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">printchplflags</span></code>: To
print flags and files to be passed to <code class="docutils literal notranslate"><span class="pre">chpl</span></code> for this
prerequisite to be linked with the Chapel application or library.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>Based on these requirements, the file structure should look like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Hello/
├── src/
│   └── Hello.chpl
├── prereqs/
│   └── some-c-lib/
│       └── hello.c
│       └── hello.h
│       └── Makefile
└── Mason.toml
</pre></div>
</div>
<p>Where a simple <cite>Makefile</cite> could look like:</p>
<div class="highlight-Makefile notranslate"><div class="highlight"><pre><span></span><span class="nf">all</span><span class="o">:</span>
<span class="w">     </span>gcc<span class="w"> </span>-c<span class="w"> </span>-fPIE<span class="w"> </span>hello.c

<span class="nf">printchplflags</span><span class="o">:</span>
<span class="w">     </span>@<span class="k">$(</span>info<span class="w"> </span>prereqs/some-c-lib/hello.h<span class="w"> </span>prereqs/some-c-lib/hello.o<span class="k">)</span>

<span class="nf">clean</span><span class="o">:</span><span class="w">  </span><span class="c"># not needed or used by Mason</span>
<span class="w">     </span>rm<span class="w"> </span>-f<span class="w"> </span>hello.o
</pre></div>
</div>
<p>In this setup, <cite>mason build</cite> will roughly do the following:</p>
<ol class="arabic simple">
<li><p>Walk into <code class="docutils literal notranslate"><span class="pre">prereqs/some-c-lib</span></code>,</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span></code>, which will result in creating the object file
<code class="docutils literal notranslate"><span class="pre">prereqs/some-c-lib/hello.o</span></code>,</p></li>
<li><p>Go back to the project root,</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">chpl</span> <span class="pre">prereqs/some-c-lib/hello.h</span> <span class="pre">prereqs/some-c-lib/hello.o</span> <span class="pre">src/Hello.chpl</span></code></p></li>
</ol>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading"></a></h2>
<p>This is a new feature added to Mason as of Chapel 2.7 and it is expected to get
more robust and capable. One important direction we want to take is to enable
more custom build process for each prerequisites, rather than prescriptive
nature of the current implementation. <a class="reference external" href="https://github.com/chapel-lang/chapel/issues/28174">This feature request</a> captures the wish and
has potential directions for it. Please comment under it if you have any
thoughts. If you have other requests on this relatively new feature, please
<a class="reference external" href="https://github.com/chapel-lang/chapel/issues/new?template=01-feature_request.md">create an issue</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="externaldependencies.html" class="btn btn-neutral float-left" title="Using Non-Chapel Dependencies" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="masonregistry.html" class="btn btn-neutral float-right" title="Mason-Registry" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Chapel a Series of LF Projects, LLC.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>